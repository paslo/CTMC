\documentclass[a4paper,reqno]{amsart}
\usepackage[british]{babel}
%\usepackage[garamond]{mathdesign}
\usepackage{mathptmx}
\usepackage{courier}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{amsthm}
\usepackage{enumerate}
\usepackage{enumitem}
\usepackage{tikz}
\usepackage{nicefrac}
%\usepackage{pdfsync}
\renewcommand{\ttdefault}{cmtt}
\newtheorem{theorem}{Theorem}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{definition}{Definition}
\newtheorem{remark}{Remark}
\newtheorem*{remark*}{Remark}
% - macros

\newcommand{\nats}{\mathbb{N}}
\newcommand{\natswith}{\nats_{0}}
\newcommand{\reals}{\mathbb{R}}

\newcommand{\states}{\mathcal{X}}

\newcommand{\paths}{\Omega}
\newcommand{\path}{\omega}

\newcommand{\power}{\mathcal{P}(\paths)}
\newcommand{\nonemptypower}{\power_{\emptyset}}
\newcommand{\events}{\mathcal{E}}
%\newcommand{\nonemptyevents}{\events^{\emptyset}}
\newcommand{\filter}[1][t]{\mathcal{F}_{#1}}
\newcommand{\eventst}[1][t]{\events_{#1}}

\newcommand{\processes}{\mathbb{P}}
\newcommand{\mprocesses}{\processes^{\mathrm{M}}}


\newcommand{\lt}{\underline{T}}
\newcommand{\lbound}{L}

\newcommand{\gambles}{\mathcal{L}}
\newcommand{\gamblesX}{\gambles(\states)} 

\newcommand{\ind}[1]{\mathbb{I}_{#1}}

\newcommand{\rateset}{\mathcal{Q}}
\newcommand{\lrate}{\underline{Q}}

\newcommand{\asa}{\Leftrightarrow}
\newcommand{\then}{\Rightarrow}

\newcommand{\norm}[1]{\left\lVert #1 \right\rVert}
\newcommand{\abs}[1]{\left\vert #1 \right\vert}

\begin{document}
\title{Continuous-time Imprecise Markov Chains}
\author{Jasper De Bock}
%\address{Ghent University, SYSTeMS Research Group, Technologiepark -- Zwijnaarde 914, 9052 Zwijnaarde, Belgium}
%\email{jasper.debock@ugent.be}

\begin{abstract}
These are some rough initial ideas and results. Notation, text and maths should all still be cleaned up; the only goal of this note is to get the ideas across.
\end{abstract}

\maketitle

\section{Preliminaries}

Consider some finite \emph{state space} $\states=\{1,\dots,m\}$. A cadlag function from $[0,+\infty)$ to $\states$ is called a \emph{path}, where cadlag means that it is right continuous for all $t\in[0,+\infty)$ and that the left limit exists for all $t\in(0,+\infty)$. Let $\paths$ be the set of all paths. For any path $\path\in\paths$ and any time point $t\in[0,+\infty)$, the value of $\path$ in $t$ is denoted by $\path(t)$.

A subset $E$ of $\paths$ is called an \emph{event}. The set of all events is denoted by $\power$ and we let $\nonemptypower\coloneqq\power\setminus\{\emptyset\}$. For any $t\in[0,+\infty)$ and $x\in\states$, we define the elementary event
\begin{equation*}
(X_t=x)\coloneqq\{\path\in\paths\colon\path(t)=x\}.
\end{equation*}
Consider now any $t\in[0,+\infty)$. We then let $\events_{\geq t}$ be the algebra that is generated by all the elementary events $X_s=x$, for $s\geq t$ and $x\in\states$.\footnote{This is the smallest subset of $\power$ that contains all these elementary events and that is furthermore closed under complements, finite unions and hence also finite intersections.} Similarly, we let $\events_{\leq t}$ be the algebra that is generated by all the elementary events $X_s=x$, for $s\leq t$ and $x\in\states$. We also define $\filter\coloneqq\events_{\leq t}\setminus\{\emptyset\}$.

A full conditional finitely additive probability measure $P$ is a real-valued map from $\power\times\nonemptypower$ to $\reals$ that satisfies the following axioms. For all $A,B\in\power$ and all \mbox{$C,D\in\nonemptypower$}:
\vspace{5pt}

\begin{enumerate}[label=F\arabic*:]
\item
$P(C\vert C)=1$;
\item
$0\leq P(A\vert C)\leq 1$;
\item
$P(A\cup B\vert C)=P(A\vert C)+P(B\vert C)$ if $A\cap B=\emptyset$;
\item
$P(A\vert D)=P(A\vert C\cap D)P(B\vert C)$ if $A\subseteq C$.
\end{enumerate}
\vspace{5pt}

\noindent
For any $A\in\power$ and $C\in\nonemptypower$, we call $P(A\vert C)$ the probability of $A$ conditional on $B$. Also, for any $A\in\power$, we frequently use the shorthand notation $P(A)\coloneqq P(A\vert\paths)$ and then call $P(A)$ the probability of $A$.

\section{Stochastic processes}

A \emph{stochastic process} is the restriction of a full conditional finitely additive probability measure $P$ to some subset $\mathcal{C}$ of $\power\times\nonemptypower$ that includes at least
\begin{equation*}
\mathcal{C^*}\coloneqq\big\{
(A,C)
\colon
C\in\filter, A\in\events_{\geq t}, t\in[0,+\infty)
\big\}.
\end{equation*}
We denote the set of all such stochastic processes by $\processes$.

Let $\gamblesX$ be the set of all real-valued functions on $\states$. Consider any stochastic process $P\in\processes$ and any $t,s\in[0,+\infty)$ such that $t<s$. The transition matrix $T_t^s$ is then an $m\times m$ matrix that is defined by
\begin{equation*}
T_t^s(i,j)\coloneqq P(X_s=x_s\vert X_t=x_t)\text{ for all $x_s,x_t\in\states$}.
\end{equation*}
Obviously, this transition, matrix $T_t^s$ can also be regarded as a map from $\gamblesX$ to $\gamblesX$, defined for all $f\in\gamblesX$ by $T_t^s(f)\coloneqq T_t^sf$.

We say that a stochastic process $P\in\processes$ satisfies the \emph{Markov property} when, for any time sequence $0\leq t_1<t_2,\dots,t_{n}<t<s$ and set of states $x_{t_1},x_{t_2},\dots,x_{t_n},x_t,x_s\in\states$:
\begin{equation*}
P(X_s=x_s\vert X_t=x_t)=P(X_s=x_s\vert X_{t_1}=X_t=x_t,x_{t_1},X_{t_2}=x_{t_2}, \dots, X_{t_n}=x_{t_n}, X_{t_1}=x_{t}).
\end{equation*}
We denote the set of all stochastic processes that satisfy this Markov property by $\mprocesses$


\begin{lemma}
Consider any $P\in\mprocesses$. Then
\begin{equation*}
T_t^s=\prod_{k=1}^n T_{t_{k-1}}^{t_k} \coloneqq T_{t_0}^{t_1}T_{t_1}^{t_2}\cdots T_{t_{n-1}}^{t_n}
\end{equation*}
for every sequence $0\leq t=t_0<t_1<t_2,\dots,t_{n}=s$.
\end{lemma}
\begin{proof}
This property is well known and therefore stated without proof.
\end{proof}

\section{The norms that are used in this document}

For any vector $f\in\gamblesX$, we let $\norm{f}\coloneqq\norm{f}_{\infty}\coloneqq\max\{\abs {f(x)}\colon x\in\states\}$ be the maximum norm. For any $n\times n$ matrix $A$, we consider the induced operator norm

\begin{equation*}
\norm{A}\coloneqq\sup\{\norm{Af}\colon f\in\gamblesX,\norm{f}=1\}
=
\max\{\sum_{y\in\states}\abs{A(x,y)}\colon x\in\states\}.
\end{equation*}

\noindent
These norms satisfy the following properties. For all $f,g\in\gamblesX$, all $n\times n$ matrices $A,B$ and all $\lambda\in\reals$, we have that
\vspace{5pt}

\begin{enumerate}[label=N\arabic*:]
\item
$\norm{f}\geq0$
\item
$\norm{f}=0\asa f=0$
\item
$\norm{f+g}\leq\norm{f}+\norm{g}$
\item
$\norm{\lambda f}=\abs{\lambda}\norm{f}$
\item
$\norm{A}\geq0$
\item
$\norm{A}=0\asa A=0$
\item
$\norm{A+B}\leq\norm{A}+\norm{B}$
\item
$\norm{AB}\leq\norm{A}\norm{B}$
\item
$\norm{\lambda A}=\abs{\lambda}\norm{A}$
\item
$\norm{Af}\leq\norm{A}\norm{f}$
\item
$\norm{T}\leq 1$ if $T$ is a transition matrix.
\end{enumerate}
\vspace{5pt}

\noindent
Finally, for any set $\mathcal{A}$ of $n\times n$ matrices, we define

\begin{equation*}
\norm{\mathcal{A}}\coloneqq\sup\{\norm{A}\colon A\in\mathcal{A}\}.
\end{equation*}

\begin{lemma}
Consider two sequences $A_1,\dots,A_n$ and $B_1,\dots,B_n$ of transition matrixes such that, for all $i\in\{1,\dots,n\}$, $\norm{A_i-B_i}\leq c$. Then
\begin{equation*}
\norm{\prod_{i=1}^nA_i-\prod_{i=1}^nB_i}\leq nc
\end{equation*}
\end{lemma}
\begin{proof}
We provide a proof by induction. For $n=1$, the result is trivially true. Assume that the result holds for $n=k-1$. The following derivation then shows that it also holds for $n=k$: 
\begin{align*}
\norm{\prod_{i=1}^nA_i-\prod_{i=1}^nB_i}
&=
\norm{\prod_{i=1}^{n}A_i-\left(\prod_{i=1}^{n-1}A_i\right)B_n+\left(\prod_{i=1}^{n-1}A_i\right)B_n-\prod_{i=1}^{n}B_i}\\
&\leq
\left(\prod_{i=1}^{n-1}\norm{A_i}\right)\norm{A_n-B_n}+\norm{\prod_{i=1}^{n-1}A_i-\prod_{i=1}^{n-1}B_i}\norm{B_n}\\
&\leq c + \norm{\prod_{i=1}^{n-1}A_i-\prod_{i=1}^{n-1}B_i}\leq c+(n-1)c= nc.
\end{align*}
\end{proof}




\section{Sets of rate matrices and lower transition operators}

A real-valued $m\times m$ matrix $Q$ is said to be a rate matrix if

\vspace{5pt}
\begin{enumerate}[label=R\arabic*:]
\item
$\sum_{y\in\states}Q(x,y)=0$ for all $x\in\states$;
\item
$Q(x,y)\geq0$ for all $x,y\in\states$ such that $x\neq y$.
\end{enumerate}
\vspace{5pt}

A set $\rateset$ of rate matrices is said to be bounded if $\inf\{Q(x,x)\colon Q\in\rateset\}>-\infty$ for all $x\in\states$ or, equivalently, if $\norm{\rateset}<\infty$. For any such bounded set $\rateset$ of rate matrices, the corresponding \emph{lower transition rate operator} $\lrate$ is a map from $\gamblesX$ to $\gamblesX$. For all $f\in\gamblesX$, $\lrate f$ is defined by

\begin{equation*}
(\lrate f)(x)\coloneqq\inf\{(Qf)(x)\colon Q\in\rateset\}\text{ for all $x\in\states$}.
\end{equation*}.

Consider now any $t,s\in[0,+\infty)$ such that $t<s$ and let $\rateset$ be an arbitrary bounded set of rate matrices with corresponding lower transition rate operator $\lrate$. The lower transition operator $\lbound_t^s$ is then a map from $\gamblesX$ to $\gamblesX$, defined by
\begin{equation}\label{eq:lowerbound}
\lbound_t^s\coloneqq\lim_{\sigma(u)\to0}\prod_{k=1}^n(I+\Delta_k\lrate),
\end{equation}
where the limit is taken with respect to the set $\mathcal{U}_{[t,s]}$ of all sequences $t=t_0<t_1<\dots<t_n=s$ and where, for any $u\in\mathcal{U}_{[t,s]}$, we first define $\Delta_i\coloneqq t_i-t_{i-1}$ for all $i\in\{1,\dots,n\}$ and then let $\sigma(u)\coloneqq\max\{\Delta_i\colon i\in\{1,\dots,n\}\}$. The following result establishes that the limit in Equation~\eqref{eq:lowerbound} exists.

\begin{theorem}
Consider any $t,s\in[0,+\infty)$ such that $t<s$ and let $\rateset$ be an arbitrary bounded set of rate matrices with corresponding lower transition operator $\lbound_t^s$. For all \mbox{$f\in\gamblesX$}, there will then be some $g\in\gamblesX$ such that:
\begin{equation*}
(\forall\epsilon>0)\,
(\exists\delta>0)\,
(\forall u\in\mathcal{U}_{[t,s]}\colon\sigma(u)<\delta)~
\lVert g - \prod_{k=1}^n(I+\Delta_k\lrate)f \rVert<\epsilon.
\end{equation*}
\end{theorem}
\begin{proof}
*** I am confident that this is true, but proving it will not be trivial... ***
\end{proof}

The left derivative of $\lbound_t^s$ with respect to $t$ furthermore satisfies Damjan's differential equation.

\begin{proposition}
Consider any $t,s\in[0,+\infty)$ such that $t<s$ and let $\rateset$ be an arbitrary bounded set of rate matrices with corresponding lower transition operator $\lbound_t^s$. For all \mbox{$f\in\gamblesX$}, we then have that
\begin{equation*}
(\forall\epsilon>0)\,
(\exists\delta>0)\,
(\forall\Delta\in(0,\delta))~
\Big\lVert\frac{L_{t-\Delta}^sf-L_t^sf}{\Delta}-\lrate L_t^sf\Big\rVert<\epsilon.
\end{equation*}

\end{proposition}
\begin{proof}
*** I am confident that this is true, but proving it will not be trivial... ***
\end{proof}

\section{The Markovian (but possibly time-inhomogeneous) case}

For any bounded set of rate matrices $\rateset$, we consider the set $\mprocesses_{\rateset}$ of all $P\in\mprocesses$ such that
\begin{equation*}
(\forall\epsilon>0)\,
(\exists\delta>0)\,
(\forall t\in[0,+\infty))\,
(\forall\Delta\in(0,\delta))\,
(\exists Q\in\rateset)~
\Big\lVert\frac{P_t^{t+\Delta}-I}{\Delta}-Q\Big\rVert<\epsilon.
\end{equation*}
%\vspace{5pt}

\begin{theorem}
Consider any $t,s\in[0,+\infty)$ such that $t<s$ and let $\rateset$ be an arbitrary bounded set of rate matrices with corresponding lower transition rate operator $\lrate$. Then for any $P\in\mprocesses_\rateset$:
\begin{equation*}
\lbound_t^sf(x)\leq T_t^sf(x)
\text{ for all $f\in\gamblesX$ and all $x\in\states$.}
\end{equation*}
\end{theorem}
\begin{proof}
*** I am confident that this is true, but proving it will not be trivial... ***
\end{proof}

\begin{theorem}
Consider any $t,s\in[0,+\infty)$ such that $t<s$ and let $\rateset$ be an arbitrary compact and bounded set of rate matrices that has separately specified rows, with corresponding lower transition rate operator $\lrate$. Then for all $f\in\gamblesX$, there is some $P\in\mprocesses_Q$ such that
\begin{equation*}
\lbound_t^sf(x)=T_t^sf(x)
\text{ for all $x\in\states$.}
\end{equation*}
\end{theorem}
\begin{proof}
*** The time-inhomogenous Markov chain for which $Q_v\coloneqq\lrate\lbound_v^sf$ establishes the equality. ***
\end{proof}

\section{Lemma's that might turn out to be useful}

\begin{lemma}
Consider a rate matrix $Q$. Then for all $\epsilon>0$, there is some $\delta>0$ such that for all $\Delta_1,\dots,\Delta_n>0$ with $\Delta\coloneqq\sum_{j=1}^n\Delta_j<\delta$, it holds that
\begin{equation*}
\Delta<\delta\then\left\lVert\left(\prod_{j=1}^n[I+\Delta_j Q]\right)-(I+\Delta Q)\right\rVert<\epsilon\Delta
\end{equation*}


\end{lemma}
\begin{proof}
Fix $\epsilon>0$. Since $\frac{d}{dt}e^{t\lVert Q\rVert}\vert_{t=0}=\lVert Q\rVert$, there is some $\delta>0$ such that, for all $0<t<\delta$, $\big\vert e^{t\lVert Q\rVert}- (1+t\lVert Q\rVert)\big\vert<\epsilon t$. Consider now any $\Delta_1,\dots,\Delta_n>0$ such that $\Delta\coloneqq\sum_{j=1}^n\Delta_j<\delta$. Then
\begin{multline*}
\left\lVert\left(\prod_{j=1}^n[I+\Delta_j Q]\right)-(I+\Delta Q)\right\rVert\\
\begin{aligned}
&=
\left\lVert\left(I+Q\sum_{j=1}^n\Delta_j+Q^2\sum_{1\leq j<j'\leq n}\Delta_j\Delta_{j'}+ \dots +Q^n\prod_{j=1}^n\Delta_j\right)-(I+\Delta Q)\right\rVert\\
&=
\left\lVert Q^2\sum_{1\leq j<j'\leq n}\Delta_j\Delta_{j'}+ \dots +Q^n\prod_{j=1}^n\Delta_j \right\rVert\\
&\leq
{\lVert Q\rVert}^2\sum_{1\leq j<j'\leq n}\Delta_j\Delta_{j'}+ \dots +{\lVert Q\rVert}^n\prod_{j=1}^n\Delta_j\\
&=\left(\prod_{j=1}^n[1+\Delta_j\lVert Q\rVert]\right)-(1+\Delta\lVert Q\rVert)\\
&\leq \left(1+\frac{\Delta\lVert Q\rVert}{n}\right)^n-(1+\Delta\lVert Q\rVert)
\leq e^{\Delta\lVert Q\rVert}-(1+\Delta\lVert Q\rVert)
<\epsilon\Delta.
\end{aligned}
\end{multline*}
\end{proof}

\bibliographystyle{plain} 
%\bibliography{general}


\end{document}
