\documentclass[a4paper,reqno]{amsart}
\usepackage[british]{babel}
%\usepackage[garamond]{mathdesign}
\usepackage{mathptmx}
\usepackage{courier}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{amsthm}
\usepackage{enumerate}
\usepackage{enumitem}
\usepackage{tikz}
\usepackage{nicefrac}
%\usepackage{pdfsync}
\renewcommand{\ttdefault}{cmtt}
\newtheorem{theorem}{Theorem}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{definition}{Definition}
\newtheorem{remark}{Remark}
\newtheorem*{remark*}{Remark}
% - macros

\newcommand{\nats}{\mathbb{N}}
\newcommand{\natswith}{\nats_{0}}
\newcommand{\reals}{\mathbb{R}}

\newcommand{\states}{\mathcal{X}}

\newcommand{\paths}{\Omega}
\newcommand{\path}{\omega}

\newcommand{\power}{\mathcal{P}(\paths)}
\newcommand{\nonemptypower}{\power_{\emptyset}}
\newcommand{\events}{\mathcal{E}}
%\newcommand{\nonemptyevents}{\events^{\emptyset}}
\newcommand{\filter}[1][t]{\mathcal{F}_{#1}}
\newcommand{\eventst}[1][t]{\events_{#1}}

\newcommand{\processes}{\mathbb{P}}
\newcommand{\mprocesses}{\processes^{\mathrm{M}}}


\newcommand{\lt}{\underline{T}}
\newcommand{\lbound}{L}

\newcommand{\gambles}{\mathcal{L}}
\newcommand{\gamblesX}{\gambles(\states)} 

\newcommand{\ind}[1]{\mathbb{I}_{#1}}

\newcommand{\rateset}{\mathcal{Q}}
\newcommand{\lrate}{\underline{Q}}

\newcommand{\asa}{\Leftrightarrow}
\newcommand{\then}{\Rightarrow}

\newcommand{\norm}[1]{\left\lVert #1 \right\rVert}
\newcommand{\abs}[1]{\left\vert #1 \right\vert}

\begin{document}
\title{Continuous-time Imprecise Markov Chains}
\author{Jasper De Bock}
%\address{Ghent University, SYSTeMS Research Group, Technologiepark -- Zwijnaarde 914, 9052 Zwijnaarde, Belgium}
%\email{jasper.debock@ugent.be}

\begin{abstract}
These are some rough initial ideas and results. Notation, text and maths should all still be cleaned up; the only goal of this note is to get the ideas across.
\end{abstract}

\maketitle

\section{Preliminaries}

Consider some finite \emph{state space} $\states=\{1,\dots,m\}$. A cadlag function from $[0,+\infty)$ to $\states$ is called a \emph{path}, where cadlag means that it is right continuous for all $t\in[0,+\infty)$ and that the left limit exists for all $t\in(0,+\infty)$. Let $\paths$ be the set of all paths. For any path $\path\in\paths$ and any time point $t\in[0,+\infty)$, the value of $\path$ in $t$ is denoted by $\path(t)$.

A subset $E$ of $\paths$ is called an \emph{event}. The set of all events is denoted by $\power$ and we let $\nonemptypower\coloneqq\power\setminus\{\emptyset\}$. For any $t\in[0,+\infty)$ and $x\in\states$, we define the elementary event
\begin{equation*}
(X_t=x)\coloneqq\{\path\in\paths\colon\path(t)=x\}.
\end{equation*}
Consider now any $t\in[0,+\infty)$. We then let $\events_{\geq t}$ be the algebra that is generated by all the elementary events $X_s=x$, for $s\geq t$ and $x\in\states$.\footnote{This is the smallest subset of $\power$ that contains all these elementary events and that is furthermore closed under complements, finite unions and hence also finite intersections.} Similarly, we let $\events_{\leq t}$ be the algebra that is generated by all the elementary events $X_s=x$, for $s\leq t$ and $x\in\states$. We also define $\filter\coloneqq\events_{\leq t}\setminus\{\emptyset\}$.

A full conditional finitely additive probability measure $P$ is a real-valued map from $\power\times\nonemptypower$ to $\reals$ that satisfies the following axioms. For all $A,B\in\power$ and all \mbox{$C,D\in\nonemptypower$}:
\vspace{5pt}

\begin{enumerate}[label=F\arabic*:]
\item
$P(C\vert C)=1$;
\item
$0\leq P(A\vert C)\leq 1$;
\item
$P(A\cup B\vert C)=P(A\vert C)+P(B\vert C)$ if $A\cap B=\emptyset$;
\item
$P(A\vert D)=P(A\vert C\cap D)P(C\vert D)$ if $A\subseteq C$.
\end{enumerate}
\vspace{5pt}

\noindent
For any $A\in\power$ and $C\in\nonemptypower$, we call $P(A\vert C)$ the probability of $A$ conditional on $B$. Also, for any $A\in\power$, we frequently use the shorthand notation $P(A)\coloneqq P(A\vert\paths)$ and then call $P(A)$ the probability of $A$.

\section{Stochastic processes}

A \emph{stochastic process} is the restriction of a full conditional finitely additive probability measure $P$ to some subset $\mathcal{C}$ of $\power\times\nonemptypower$ that includes at least
\begin{equation*}
\mathcal{C^*}\coloneqq\big\{
(A,C)
\colon
C\in\filter, A\in\events_{\geq t}, t\in[0,+\infty)
\big\}.
\end{equation*}
We denote the set of all such stochastic processes by $\processes$.

Let $\gamblesX$ be the set of all real-valued functions on $\states$. Consider any stochastic process $P\in\processes$ and any $t,s\in[0,+\infty)$ such that $t<s$. The transition matrix $T_t^s$ is then an $m\times m$ matrix that is defined by
\begin{equation*}
T_t^s(i,j)\coloneqq P(X_s=x_s\vert X_t=x_t)\text{ for all $x_s,x_t\in\states$}.
\end{equation*}
Obviously, this transition, matrix $T_t^s$ can also be regarded as a map from $\gamblesX$ to $\gamblesX$, defined for all $f\in\gamblesX$ by $T_t^s(f)\coloneqq T_t^sf$.

We say that a stochastic process $P\in\processes$ satisfies the \emph{Markov property} when, for any time sequence $0\leq t_1<t_2,\dots,t_{n}<t<s$ and set of states $x_{t_1},x_{t_2},\dots,x_{t_n},x_t,x_s\in\states$:
\begin{equation*}
P(X_s=x_s\vert X_t=x_t)=P(X_s=x_s\vert X_{t_1}=X_t=x_t,x_{t_1},X_{t_2}=x_{t_2}, \dots, X_{t_n}=x_{t_n}, X_{t_1}=x_{t}).
\end{equation*}
We denote the set of all stochastic processes that satisfy this Markov property by $\mprocesses$


\begin{lemma}\label{lemma:transitionmatrixfactorises}
Consider any $P\in\mprocesses$. Then
\begin{equation*}
T_t^s=\prod_{k=1}^n T_{t_{k-1}}^{t_k} \coloneqq T_{t_0}^{t_1}T_{t_1}^{t_2}\cdots T_{t_{n-1}}^{t_n}
\end{equation*}
for every sequence $0\leq t=t_0<t_1<t_2,\dots,t_{n}=s$.
\end{lemma}
\begin{proof}
This property is well known and therefore stated without proof.
\end{proof}

\section{The norms that are used in this document}

For any vector $f\in\gamblesX$, we let $\norm{f}\coloneqq\norm{f}_{\infty}\coloneqq\max\{\abs {f(x)}\colon x\in\states\}$ be the maximum norm. For any operator $A$ from $\gamblesX$ to $\gamblesX$ that is non-negatively homogeneous, meaning that
\begin{equation*}
A(\lambda f)=\lambda A(f)\text{ for all $f\in\gamblesX$ and all $\lambda\geq0$,}
\end{equation*}
we consider the induced operator norm
\begin{equation*}
\norm{A}\coloneqq\sup\{\norm{Af}\colon f\in\gamblesX,\norm{f}=1\}.
\end{equation*}
If $A$ is an $m\times m$ matrix, we have that
\begin{equation*}
\norm{A}
=
\max\{\sum_{y\in\states}\abs{A(x,y)}\colon x\in\states\}.
\end{equation*}


\noindent
These norms satisfy the following properties. For all $f,g\in\gamblesX$, all $A,B$ from $\gamblesX$ to $\gamblesX$ that are non-negatively homogeneous, all $\lambda\in\reals$ and all $x\in\states$, we have that
\vspace{5pt}

\begin{enumerate}[label=N\arabic*:]
\item
$\abs{f(x)}\leq\norm{f}$
\item
$\norm{f}\geq0$
\item
$\norm{f}=0\asa f=0$
\item
$\norm{f+g}\leq\norm{f}+\norm{g}$
\item
$\norm{\lambda f}=\abs{\lambda}\norm{f}$
\item
$\norm{A}\geq0$
\item
$\norm{A}=0\asa A=0$
\item
$\norm{A+B}\leq\norm{A}+\norm{B}$
\item
$\norm{AB}\leq\norm{A}\norm{B}$
\item
$\norm{\lambda A}=\abs{\lambda}\norm{A}$
\item
$\norm{Af}\leq\norm{A}\norm{f}$
\item
$\norm{A}\leq 1$ if $A$ is a stochastic matrix.
\end{enumerate}
\vspace{5pt}

\noindent
Finally, for any set $\mathcal{A}$ of $n\times n$ matrices, we define

\begin{equation*}
\norm{\mathcal{A}}\coloneqq\sup\{\norm{A}\colon A\in\mathcal{A}\}.
\end{equation*}

\begin{lemma}\label{lemma:differenceproductoftransition}
Consider two sequences $A_1,\dots,A_n$ and $B_1,\dots,B_n$ of stochastic matrixes such that, for all $i\in\{1,\dots,n\}$, $\norm{A_i-B_i}\leq c$. Then
\begin{equation*}
\norm{\prod_{i=1}^nA_i-\prod_{i=1}^nB_i}\leq nc
\end{equation*}
\end{lemma}
\begin{proof}
We provide a proof by induction. For $n=1$, the result is trivially true. Assume that the result holds for $n=k-1$. The following derivation then shows that it also holds for $n=k$: 
\begin{align*}
\norm{\prod_{i=1}^nA_i-\prod_{i=1}^nB_i}
&=
\norm{\prod_{i=1}^{n}A_i-\left(\prod_{i=1}^{n-1}A_i\right)B_n+\left(\prod_{i=1}^{n-1}A_i\right)B_n-\prod_{i=1}^{n}B_i}\\
&\leq
\left(\prod_{i=1}^{n-1}\norm{A_i}\right)\norm{A_n-B_n}+\norm{\prod_{i=1}^{n-1}A_i-\prod_{i=1}^{n-1}B_i}\norm{B_n}\\
&\leq c + \norm{\prod_{i=1}^{n-1}A_i-\prod_{i=1}^{n-1}B_i}\leq c+(n-1)c= nc.
\end{align*}
\end{proof}




\section{Sets of rate matrices and lower transition rate operators}

A real-valued $m\times m$ matrix $Q$ is said to be a rate matrix if

\vspace{5pt}
\begin{enumerate}[label=R\arabic*:]
\item
$\sum_{y\in\states}Q(x,y)=0$ for all $x\in\states$;
\item
$Q(x,y)\geq0$ for all $x,y\in\states$ such that $x\neq y$.
\end{enumerate}
\vspace{5pt}
\noindent
We use $\mathcal{R}$ to denote the set of all rate matrices. Clearly, $\mathcal{R}$ is closed under finite sums and multiplication with non-negative scalars. For any set $\rateset\subseteq\mathcal{R}$ of rate matrices, we let
\begin{equation*}
\rateset_x\coloneqq\{Q(x,\cdot)\colon Q\in\rateset\}
\text{ for all $x\in\states$.}
\end{equation*}
We say that $\rateset$ has \emph{separately specified rows} if
\begin{equation*}
Q\in\rateset\asa(\forall x\in\states)~Q(x,\cdot)\in\rateset_x.
\end{equation*}
A set $\rateset\subseteq\mathcal{R}$ of rate matrices is said to be bounded if $\inf\{Q(x,x)\colon Q\in\rateset\}>-\infty$ for all $x\in\states$ or, equivalently, if $\norm{\rateset}<\infty$. 

For any bounded set $\rateset$ of rate matrices, the corresponding \emph{lower transition rate operator} $\lrate$ is a map from $\gamblesX$ to $\gamblesX$. For all $f\in\gamblesX$, $\lrate f$ is defined by
\begin{equation}\label{eq:deflowerbound}
(\lrate f)(x)\coloneqq\inf\{(Qf)(x)\colon Q\in\rateset\}\text{ for all $x\in\states$}.
\end{equation}
We will call a map $\lrate$ from $\gamblesX$ to $\gamblesX$ a \emph{coherent} lower transition rate operator if, for all $f,g\in\gamblesX$, $\lambda\geq0$ and $\mu\in\reals$:

\vspace{5pt}
\begin{enumerate}[label=LR\arabic*:]
\item
$\lrate(\mu)=0$;
\item
$\lrate(f+g)\geq\lrate(f)+\lrate(g)$;
\item
$\lrate(\lambda f)=\lambda\lrate(f)$;
\item
$\lrate(\ind{y})(x)\geq0$ for all $x,y\in\states$ such that $x\neq y$.
\end{enumerate}
\vspace{5pt}

\begin{lemma}\label{lemma:lrateiscoherent}
For any bounded set $\rateset$ of rate matrices, the corresponding lower transition rate operator $\lrate$ is coherent.
\end{lemma}
\begin{proof}
This is immediate.
\end{proof}

For any coherent lower transition rate operator $\lrate$, we use $\rateset_{\lrate}$ to denote the set of all rate matrices $Q$ that dominate $\lrate$, in the sense that
\begin{equation*}
Qf\geq\lrate f\text{ for all $f\in\gamblesX$.}
\end{equation*}

\begin{lemma}
Consider a coherent lower transition rate operator $\lrate$ and let $\rateset_{\lrate}$ be the corresponding set of dominating rate matrices. Then $\rateset_{\lrate}$ is closed, bounded and convex, and has separately specified rows. Also, for all $f\in\gamblesX$, there is some $Q\in\rateset_{\lrate}$ such that $\lrate f=Qf$. Furthermore, $\norm{\lrate}<\infty$.
\end{lemma}
\begin{proof}
*** This is not trivial, but I am convinced it is true (we would have to adapt the proof for a similar well-known result for coherent lower previsions) ***
\end{proof}

\noindent
If $\lrate$ is the coherent lower transition rate operator that corresponds to some bounded set $\rateset$ of rate matrices, then clearly: $\rateset\subseteq\rateset_{\lrate}$.

\section{Lower transition operators}

We will call a map $\lt$ from $\gamblesX$ to $\gamblesX$ a \emph{coherent lower transition operator} if, for all $f,g\in\gamblesX$, $\lambda\geq0$ and $\mu\in\reals$:

\vspace{5pt}
\begin{enumerate}[label=C\arabic*:]
\item
$\lt f\geq\min f$
\item
$\lt(f+g)\geq\lt(f)+\lt(g)$;
\item
$\lt(\lambda f)=\lambda\lt(f)$.
\end{enumerate}
\vspace{5pt}


Consider now any $t,s\in[0,+\infty)$ such that $t<s$ and let $\lrate$ be an arbitrary coherent lower transition rate operator . The corresponding lower transition operator $\lbound_t^s$ is then a map from $\gamblesX$ to $\gamblesX$, defined by
\begin{equation}\label{eq:lowerbound}
\lbound_t^s\coloneqq\lim_{\sigma(u)\to0}\prod_{k=1}^n(I+\Delta_k\lrate),
\end{equation}
where the limit is taken with respect to the set $\mathcal{U}_{[t,s]}$ of all sequences $t=t_0<t_1<\dots<t_n=s$ and where, for any $u\in\mathcal{U}_{[t,s]}$, we first define $\Delta_i\coloneqq t_i-t_{i-1}$ for all $i\in\{1,\dots,n\}$ and then let $\sigma(u)\coloneqq\max\{\Delta_i\colon i\in\{1,\dots,n\}\}$. The following result establishes that the limit in Equation~\eqref{eq:lowerbound} exists, and that it is a coherent lower transition operator.

\begin{theorem}\label{theo:convergencelowerbound}
For any $t,s\in[0,+\infty)$ such that $t<s$ and any coherent lower transition rate operator $\lrate$, there is a coherent lower transition operator $\lbound_t^s$ such that 
\begin{equation*}
(\forall\epsilon>0)\,
(\exists\delta>0)\,
(\forall u\in\mathcal{U}_{[t,s]}\colon\sigma(u)<\delta)~\norm{\lbound_t^s - \prod_{k=1}^n(I+\Delta_k\lrate)}<\epsilon.
\end{equation*}
\end{theorem}
\begin{proof}
*** I am confident that this is true, but proving it will not be trivial... One way to do it would be to use arguments similar to the ones that I used in (the proof of) Lemma~\ref{lemma:smallerpartition}. ***
\end{proof}

The derivative of $\lbound_t^s$ with respect to $t$ furthermore satisfies differential equations in the style of Damjan.

\begin{proposition}
Consider any $t,s\in[0,+\infty)$ such that $t<s$, let $\lrate$ be an arbitrary coherent lower transition rate operator and let $\lbound_t^s$ be the corresponding lower transition operator. Then $\frac{d}{dt}\lbound_t^s=-\lrate\lbound_t^s$ and $\frac{d}{ds}\lbound_t^s=\lrate$, meaning that
\begin{equation*}
(\forall\epsilon>0)\,
(\exists\delta>0)\,
(\forall\Delta\in(-\delta,\delta))~
\Big\lVert\frac{L_{t+\Delta}^s-L_t^s}{\Delta}+\lrate L_t^s\Big\rVert<\epsilon
\end{equation*}
and
\begin{equation*}
(\forall\epsilon>0)\,
(\exists\delta>0)\,
(\forall\Delta\in(-\delta,\delta))~
\Big\lVert\frac{L_{t}^{s+\Delta}-L_t^s}{\Delta}-\lrate \Big\rVert<\epsilon.
\end{equation*}
\end{proposition}
\begin{proof}
*** I am confident that this is true, but proving it might not be trivial... ***
\end{proof}

\section{The Markovian (but possibly time-inhomogeneous) case}

For any bounded set of rate matrices $\rateset$, we consider the set $\mprocesses_{\rateset}$ of all $P\in\mprocesses$ such that
\begin{equation}\label{eq:conditionforMarkov}
(\forall\epsilon>0)\,
(\exists\delta>0)\,
(\forall t\in[0,+\infty))\,
(\forall\Delta\in(0,\delta))\,
(\exists Q\in\rateset)~
\Big\lVert\frac{T_t^{t+\Delta}-I}{\Delta}-Q\Big\rVert<\epsilon.
\end{equation}
%\vspace{5pt}

\begin{theorem}
Consider any $t,s\in[0,+\infty)$ such that $t<s$ and let $\rateset$ be an arbitrary bounded set of rate matrices with corresponding lower transition rate operator $\lrate$. Then for any $P\in\mprocesses_\rateset$ and $f\in\gamblesX$:
\begin{equation*}
\lbound_t^sf(x)\leq T_t^sf(x).
\end{equation*}
\end{theorem}
\begin{proof}
Consider any $P\in\mprocesses_\rateset$ and any $f\in\gamblesX$ and $x\in\states$. Assume \emph{ex absurdo} that $\lbound_t^sf(x)>T_t^sf(x)$. We prove that this leads to a contradiction.  Let $C\coloneqq t-s$ and choose $\epsilon>0$ small enough such that
\begin{equation}\label{eq:chooseepsilon}
\epsilon(1+C\norm{f})<\lbound_t^sf(x)-T_t^sf(x).
\end{equation}
Since $P\in\mprocesses_\rateset$, it follows from Equation~\eqref{eq:conditionforMarkov} that there is some $\delta>0$ such that
\begin{equation}\label{eq:1conditionforMarkov}
(\forall \tau\in[0,+\infty))\,
(\forall\Delta\in(0,\delta))\,
(\exists Q\in\rateset)~
\Big\lVert\frac{T_\tau^{\tau+\Delta}-I}{\Delta}-Q\Big\rVert<\epsilon.
\end{equation}
Furthermore, because of Equation~\eqref{eq:deflowerbound} and Theorem~\ref{theo:convergencelowerbound}, there is some $\delta'>0$ such that
\begin{equation}\label{eq:deltaprimeformula}
(\forall u\in\mathcal{U}_{[t,s]}\colon\sigma(u)<\delta')~\abs{\lbound_t^sf(x) - \left(\left(\prod_{k=1}^n(I+\Delta_k\lrate)\right)(f)\right)(x)}<\epsilon.
\end{equation}
Now choose $n>\max\{\nicefrac{C}{\delta},\nicefrac{C}{\delta'},C\norm{\rateset}\}$. Then for $\Delta\coloneqq\nicefrac{C}{n}$, we find that $\Delta<\delta$, $\Delta<\delta'$ and $\Delta\norm{\rateset}<1$. 

For all $k\in\{0,1,\dots,n\}$, define $t_k\coloneqq t+k\Delta$. Since $\Delta<\delta$, it follows from Equation~\eqref{eq:1conditionforMarkov} that, for all $i\in\{1,\dots,n\}$, there is some $Q_i\in\rateset$ such that 
\begin{equation*}
\norm{T_{t_{i-1}}^{t_i}-(I+\Delta Q_i)}
=\norm{\frac{T_{t_{i-1}}^{t_i}-I}{\Delta}-Q_i}\Delta
<\epsilon\Delta.
\end{equation*}
Furthermore, for all $i\in\{1,\dots,n\}$, since $\abs{\Delta Q_i(x,y)}\leq\norm{\Delta Q_i}=\Delta\norm{Q_i}\leq\Delta\norm{\rateset}<1$ for all $x,y\in\states$, we have that $I+\Delta Q_i$ is a stochastic matrix.
Therefore, due to Lemmas~\ref{lemma:transitionmatrixfactorises} and~\ref{lemma:differenceproductoftransition}, we find that
\begin{equation*}
\norm{T_t^s-\prod_{i=1}^n(I+\Delta Q_i)}
=\norm{\prod_{i=1}^n T_{t_{i-1}}^{t_i}-\prod_{i=1}^n(I+\Delta Q_i)}
\leq\epsilon\Delta n=\epsilon C,
\end{equation*}
which implies that
\begin{align}
\abs{T_t^sf(x)-\left(\left(\prod_{i=1}^n(I+\Delta Q_i)\right)(f)\right)(x)}
&\leq
\norm{T_t^sf-\left(\prod_{i=1}^n(I+\Delta Q_i)\right)(f)}\notag\\
&\leq
\norm{T_t^s-\prod_{i=1}^n(I+\Delta Q_i)}\norm{f}
\leq\epsilon C\norm{f}.\label{eq:firstpartofbound}
\end{align}
\noindent
Equation~\eqref{eq:deflowerbound} implies that
\begin{equation}
\left(\left(\prod_{i=1}^n(I+\Delta Q_i)\right)(f)\right)(x)
\geq
\left((I+\Delta\lrate)^n(f)\right)(x)\label{eq:middlepartofbound}
\end{equation}
and, since $\Delta<\delta'$, it follows from Equation~\eqref{eq:deltaprimeformula} that
\begin{equation}\label{eq:lastpartofbound}
\abs{\lbound_t^sf(x) - \left((I+\Delta\lrate)^n(f)\right)(x)}<\epsilon.
\end{equation}
\noindent
By combining Equations~\eqref{eq:firstpartofbound}, \eqref{eq:middlepartofbound} and~\eqref{eq:lastpartofbound}, we find that
\begin{align*}
T_t^sf(x)
&>
\left(\left(\prod_{i=1}^n(I+\Delta Q_i)\right)(f)\right)(x)-\epsilon C\norm{f}\\
&\geq
\left((I+\Delta\lrate)^n(f)\right)(x)-\epsilon C\norm{f}
>\lbound_t^sf(x)-\epsilon-\epsilon C\norm{f},
\end{align*}
which provides the required contradiction; see Equation~\eqref{eq:chooseepsilon}.
\end{proof}

\begin{theorem}
Consider any $t,s\in[0,+\infty)$ such that $t<s$ and let $\rateset$ be an arbitrary closed and bounded set of rate matrices that has separately specified rows, with corresponding lower transition rate operator $\lrate$. Then for all $f\in\gamblesX$, there is some $P\in\mprocesses_Q$ such that
\begin{equation*}
\lbound_t^sf=T_t^sf.
\end{equation*}
\end{theorem}
\begin{proof}
*** The time-inhomogenous Markov chain for which $Q_v\coloneqq\lrate\lbound_v^sf$ establishes the equality. ***
\end{proof}

\section{Lemma's which I think will turn out to be useful}

\begin{lemma}\label{lemma:smallerpartition}
Consider a rate matrix $Q$. Then for all $\epsilon>0$, there is some $\delta>0$ such that for all $\Delta_1,\dots,\Delta_n>0$ with $\Delta\coloneqq\sum_{j=1}^n\Delta_j<\delta$, it holds that
\begin{equation*}
\Delta<\delta\then\left\lVert\left(\prod_{j=1}^n[I+\Delta_j Q]\right)-(I+\Delta Q)\right\rVert<\epsilon\Delta
\end{equation*}


\end{lemma}
\begin{proof}
Fix $\epsilon>0$. Since $\frac{d}{dt}e^{t\lVert Q\rVert}\vert_{t=0}=\lVert Q\rVert$, there is some $\delta>0$ such that, for all $0<t<\delta$, $\big\vert e^{t\lVert Q\rVert}- (1+t\lVert Q\rVert)\big\vert<\epsilon t$. Consider now any $\Delta_1,\dots,\Delta_n>0$ such that $\Delta\coloneqq\sum_{j=1}^n\Delta_j<\delta$. Then
\begin{multline*}
\left\lVert\left(\prod_{j=1}^n[I+\Delta_j Q]\right)-(I+\Delta Q)\right\rVert\\
\begin{aligned}
&=
\left\lVert\left(I+Q\sum_{j=1}^n\Delta_j+Q^2\sum_{1\leq j<j'\leq n}\Delta_j\Delta_{j'}+ \dots +Q^n\prod_{j=1}^n\Delta_j\right)-(I+\Delta Q)\right\rVert\\
&=
\left\lVert Q^2\sum_{1\leq j<j'\leq n}\Delta_j\Delta_{j'}+ \dots +Q^n\prod_{j=1}^n\Delta_j \right\rVert\\
&\leq
{\lVert Q\rVert}^2\sum_{1\leq j<j'\leq n}\Delta_j\Delta_{j'}+ \dots +{\lVert Q\rVert}^n\prod_{j=1}^n\Delta_j\\
&=\left(\prod_{j=1}^n[1+\Delta_j\lVert Q\rVert]\right)-(1+\Delta\lVert Q\rVert)\\
&\leq \left(1+\frac{\Delta\lVert Q\rVert}{n}\right)^n-(1+\Delta\lVert Q\rVert)
\leq e^{\Delta\lVert Q\rVert}-(1+\Delta\lVert Q\rVert)
<\epsilon\Delta.
\end{aligned}
\end{multline*}
\end{proof}


\bibliographystyle{plain} 
%\bibliography{general}


\end{document}
